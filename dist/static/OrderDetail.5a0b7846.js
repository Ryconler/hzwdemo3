var W=(e,d,o)=>new Promise((i,r)=>{var B=n=>{try{m(o.next(n))}catch(s){r(s)}},k=n=>{try{m(o.throw(n))}catch(s){r(s)}},m=n=>n.done?i(n.value):Promise.resolve(n.value).then(B,k);m((o=o.apply(e,d)).next())});import{r as _e,u as ve,O as ee,j as De,_ as we,a as te,g as Ee}from"./order.f074976b.js";import{r as N,E as he,a5 as se,at as xe,w as f,b as K,aj as Fe,T as A,ag as Se,V as P,M as Pe,Y as ge,aa as Te,au as Ie,Q as le,O as Ae,ab as Oe,al as ue,G as $e,ac as Ne,e as y,f as t,g as a,av as j,j as w,v as L,t as v,ad as ie,F as ne,i as re,n as Re,ae as ze,D as He,aw as Me,o as C,k as ce,p as Ye,h as Le,ax as Ve,ay as de}from"./index.18b16d2b.js";import{v as Ke,c as J,t as oe,w as X,m as M,n as pe,B as Ue,I as We,p as je,L as qe,f as Ge,x as Qe,u as Je,y as Xe,e as Ze,P as et,z as tt,A as nt,l as ot,C as at,D as st,_ as lt,a as ut,T as q}from"./plugin-vue_export-helper.94e3df31.js";import{a as it,c as rt}from"./order.48d51711.js";import{h as G}from"./moment.84387b76.js";import"./urlPrefixes.3f603d54.js";const ct=(e,d)=>{const o=N(),i=()=>{o.value=xe(e).height};return he(()=>{if(se(i),d)for(let r=1;r<=3;r++)setTimeout(i,100*r)}),Ke(()=>se(i)),o};function dt(e,d){const o=ct(e,!0);return i=>f("div",{class:d("placeholder"),style:{height:o.value?`${o.value}px`:void 0}},[i()])}const[Ce,me]=J("action-bar"),Be=Symbol(Ce),mt={placeholder:Boolean,safeAreaInsetBottom:oe};var ft=K({name:Ce,props:mt,setup(e,{slots:d}){const o=N(),i=dt(o,me),{linkChildren:r}=Fe(Be);r();const B=()=>{var k;return f("div",{ref:o,class:[me(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(k=d.default)==null?void 0:k.call(d)])};return()=>e.placeholder?i(B):B()}});const _t=X(ft),[vt,H]=J("button"),ht=A({},_e,{tag:M("button"),text:String,icon:String,type:M("default"),size:M("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:M("button"),loadingSize:pe,loadingText:String,loadingType:String,iconPosition:M("left")});var gt=K({name:vt,props:ht,emits:["click"],setup(e,{emit:d,slots:o}){const i=ve(),r=()=>o.loading?o.loading():f(qe,{size:e.loadingSize,type:e.loadingType,class:H("loading")},null),B=()=>{if(e.loading)return r();if(o.icon)return f("div",{class:H("icon")},[o.icon()]);if(e.icon)return f(We,{name:e.icon,class:H("icon"),classPrefix:e.iconPrefix},null)},k=()=>{let s;if(e.loading?s=e.loadingText:s=o.default?o.default():e.text,s)return f("span",{class:H("text")},[s])},m=()=>{const{color:s,plain:E}=e;if(s){const p={color:E?s:"white"};return E||(p.background=s),s.includes("gradient")?p.border=0:p.borderColor=s,p}},n=s=>{e.loading?je(s):e.disabled||(d("click",s),i())};return()=>{const{tag:s,type:E,size:p,block:T,round:R,plain:O,square:b,loading:$,disabled:l,hairline:h,nativeType:x,iconPosition:D}=e,I=[H([E,p,{plain:O,block:T,round:R,square:b,loading:$,disabled:l,hairline:h}]),{[Ue]:h}];return f(s,{type:x,class:I,style:m(),disabled:l,onClick:n},{default:()=>[f("div",{class:H("content")},[D==="left"&&B(),k(),D==="right"&&B()])]})}}});const ae=X(gt),[pt,Ct]=J("action-bar-button"),Bt=A({},_e,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var yt=K({name:pt,props:Bt,setup(e,{slots:d}){const o=ve(),{parent:i,index:r}=Se(Be),B=P(()=>{if(i){const m=i.children[r.value-1];return!(m&&"isButton"in m)}}),k=P(()=>{if(i){const m=i.children[r.value+1];return!(m&&"isButton"in m)}});return Ge({isButton:!0}),()=>{const{type:m,icon:n,text:s,color:E,loading:p,disabled:T}=e;return f(ae,{class:Ct([m,{last:k.value,first:B.value}]),size:"large",type:m,icon:n,color:E,loading:p,disabled:T,onClick:o},{default:()=>[d.default?d.default():s]})}}});const fe=X(yt),[bt,S,Q]=J("dialog"),kt=A({},Qe,{title:String,theme:String,width:pe,message:[String,Function],callback:Function,allowHtml:Boolean,className:Je,transition:M("van-dialog-bounce"),messageAlign:String,closeOnPopstate:oe,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:oe,closeOnClickOverlay:Boolean}),Dt=[...Xe,"transition","closeOnPopstate"];var ye=K({name:bt,props:kt,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:d,slots:o}){const i=N(),r=Pe({confirm:!1,cancel:!1}),B=l=>d("update:show",l),k=l=>{var h;B(!1),(h=e.callback)==null||h.call(e,l)},m=l=>()=>{!e.show||(d(l),e.beforeClose?(r[l]=!0,ot(e.beforeClose,{args:[l],done(){k(l),r[l]=!1},canceled(){r[l]=!1}})):k(l))},n=m("cancel"),s=m("confirm"),E=Ie(l=>{var h,x;if(l.target!==((x=(h=i.value)==null?void 0:h.popupRef)==null?void 0:x.value))return;({Enter:e.showConfirmButton?s:le,Escape:e.showCancelButton?n:le})[l.key](),d("keydown",l)},["enter","esc"]),p=()=>{const l=o.title?o.title():e.title;if(l)return f("div",{class:S("header",{isolated:!e.message&&!o.default})},[l])},T=l=>{const{message:h,allowHtml:x,messageAlign:D}=e,I=S("message",{"has-title":l,[D]:D}),z=Ae(h)?h():h;return x&&typeof z=="string"?f("div",{class:I,innerHTML:z},null):f("div",{class:I},[z])},R=()=>{if(o.default)return f("div",{class:S("content")},[o.default()]);const{title:l,message:h,allowHtml:x}=e;if(h){const D=!!(l||o.title);return f("div",{key:x?1:0,class:S("content",{isolated:!D})},[T(D)])}},O=()=>f("div",{class:[nt,S("footer")]},[e.showCancelButton&&f(ae,{size:"large",text:e.cancelButtonText||Q("cancel"),class:S("cancel"),style:{color:e.cancelButtonColor},loading:r.cancel,disabled:e.cancelButtonDisabled,onClick:n},null),e.showConfirmButton&&f(ae,{size:"large",text:e.confirmButtonText||Q("confirm"),class:[S("confirm"),{[tt]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:r.confirm,disabled:e.confirmButtonDisabled,onClick:s},null)]),b=()=>f(_t,{class:S("footer")},{default:()=>[e.showCancelButton&&f(fe,{type:"warning",text:e.cancelButtonText||Q("cancel"),class:S("cancel"),color:e.cancelButtonColor,loading:r.cancel,disabled:e.cancelButtonDisabled,onClick:n},null),e.showConfirmButton&&f(fe,{type:"danger",text:e.confirmButtonText||Q("confirm"),class:S("confirm"),color:e.confirmButtonColor,loading:r.confirm,disabled:e.confirmButtonDisabled,onClick:s},null)]}),$=()=>o.footer?o.footer():e.theme==="round-button"?b():O();return()=>{const{width:l,title:h,theme:x,message:D,className:I}=e;return f(et,ge({ref:i,role:"dialog",class:[S([x]),I],style:{width:Ze(l)},tabindex:0,"aria-labelledby":h||D,onKeydown:E,"onUpdate:show":B},Te(e,Dt)),{default:()=>[p(),R(),$()]})}}});let V;function wt(){({instance:V}=at({setup(){const{state:d,toggle:o}=st();return()=>f(ye,ge(d,{"onUpdate:show":o}),null)}}))}function g(e){return Oe?new Promise((d,o)=>{V||wt(),V.open(A({},g.currentOptions,e,{callback:i=>{(i==="confirm"?d:o)(i)}}))}):Promise.resolve()}g.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};g.currentOptions=A({},g.defaultOptions);g.alert=g;g.confirm=e=>g(A({showCancelButton:!0},e));g.close=()=>{V&&V.toggle(!1)};g.setDefaultOptions=e=>{A(g.currentOptions,e)};g.resetDefaultOptions=()=>{g.currentOptions=A({},g.defaultOptions)};g.Component=X(ye);g.install=e=>{e.use(g.Component),e.config.globalProperties.$dialog=g};const _=e=>(Ye("data-v-6c557337"),e=e(),Le(),e),Et={key:0,class:"order-detail"},xt={key:1,class:"order-status pf-medium"},Ft={key:2,class:"order-text pf-medium"},St={key:3,class:"order-text pf-medium"},Pt=_(()=>t("i",null,null,-1)),Tt={class:"order-detail-wrap"},It={key:1,class:"coin"},At=_(()=>t("h2",{class:"section-title pf-medium"},"\u5E01\u503C\u4FE1\u606F",-1)),Ot={class:"table-list"},$t={class:"table-item"},Nt=_(()=>t("span",{class:"name"},"\u5145\u503C\u5E01\u503C",-1)),Rt={class:"value pf-medium"},zt={class:"table-item"},Ht=_(()=>t("span",{class:"name"},"\u8D60\u9001\u5E01\u503C",-1)),Mt={class:"value pf-medium"},Yt={class:"table-item"},Lt=_(()=>t("span",{class:"name"},"\u5230\u8D26\u5E01\u503C",-1)),Vt={class:"value pf-medium"},Kt=_(()=>t("div",{class:"dividle"},null,-1)),Ut={class:"table-list"},Wt={class:"table-item"},jt=_(()=>t("span",{class:"name"},"\u6D88\u8D39\u5E01\u503C",-1)),qt={class:"value pf-medium"},Gt={class:"table-item"},Qt=_(()=>t("span",{class:"name"},"\u5269\u4F59\u5E01\u503C",-1)),Jt={class:"value pf-medium",style:{color:"#ff397e"}},Xt=_(()=>t("p",{class:"coin-tip"},"*\u5269\u4F59\u5E01\u503C=\u5230\u8D26\u5E01\u503C-\u6D88\u8D39\u5E01\u503C",-1)),Zt={key:2,class:"promotion"},en=_(()=>t("h2",{class:"section-title pf-medium"},"\u4F18\u60E0\u4FE1\u606F",-1)),tn={class:"table-list"},nn={key:0,class:"table-item coupon"},on=_(()=>t("span",{class:"name"},"\u5145\u503C\u8FD4\u5238",-1)),an={class:"value pf-medium"},sn={class:"table-item"},ln=_(()=>t("span",{class:"name"},"\u6838\u9500\u8FD4\u5E01",-1)),un={class:"value pf-medium"},rn=_(()=>t("span",null,null,-1)),cn={class:"order"},dn=_(()=>t("h2",{class:"section-title pf-medium"},"\u8BA2\u5355\u4FE1\u606F",-1)),mn={class:"table-list"},fn={class:"table-item"},_n=_(()=>t("span",{class:"name"},"\u8D2D\u4E70\u6570\u91CF",-1)),vn={class:"value pf-medium"},hn={class:"table-item param-total"},gn=_(()=>t("span",{class:"name"},"\u5546\u54C1\u603B\u989D",-1)),pn={class:"value pf-medium"},Cn={class:"table-item param-total"},Bn={class:"name"},yn={class:"value pf-medium",style:{color:"#ff397e"}},bn={class:"big"},kn=_(()=>t("div",{class:"dividle"},null,-1)),Dn={class:"table-list"},wn={class:"table-item"},En=_(()=>t("span",{class:"name"},"\u8BA2\u5355\u7F16\u53F7\uFF1A",-1)),xn={class:"value pf-medium"},Fn={class:"table-item param-total"},Sn=_(()=>t("span",{class:"name"},"\u4E0B\u5355\u65F6\u95F4\uFF1A",-1)),Pn={class:"value pf-medium"},Tn={class:"table-item param-total"},In=_(()=>t("span",{class:"name"},"\u8BA2\u5355\u72B6\u6001\uFF1A",-1)),An={class:"value pf-medium"},On=_(()=>t("div",{class:"menu_wkBox_back_box"},null,-1)),$n={key:0,class:"order-detail-action"},Nn={class:"action-wrap"},Rn=_(()=>t("div",{class:"menu_wkBox_back_box"},null,-1)),zn={class:"dialog-container"},Hn=K({__name:"OrderDetail",setup(e){const d=g.Component,o=He();ut({title:"\u8BA2\u5355\u8BE6\u60C5",share:!1});const i=P(()=>{const u=o.query.naviType;return Ve()&&u=="4"}),r=P(()=>0),B=P(()=>i.value?de(44/37.5):de(22/37.5)),k=P(()=>b.value?b.value.hasReturn?"*\u5DF2\u6838\u9500\u8FD4\u5E01":`\u672A\u8FD4\uFF0C${b.value.endTime?b.value.endTime+"\u4E4B\u524D":""}\u5728\u6307\u5B9A\u95E8\u5E97\u6838\u9500\u5373\u53EF\u8FD4\u5E01`:""),m=N(o.params.orderId),n=N(null),s=N("");let E;const p=P(()=>n.value?Ee(n.value):{}),T=P(()=>p.value.text!="\u5F85\u652F\u4ED8"&&p.value.text!="\u5DF2\u53D6\u6D88"),R=P(()=>{var u;return n.value&&{cmmdtyImage:n.value.commdtyImage,skuName:n.value.skuName,price:n.value.skuPrice,giveAmount:n.value.giveAmount/n.value.num,rechargeAmount:n.value.rechargeAmount/n.value.num,returnCoinNum:(u=n.value.returnCoinsInfo&&n.value.returnCoinsInfo.returnCoinNum/n.value.num)!=null?u:0}}),O=P(()=>{var u;return((u=n.value)==null?void 0:u.returnCouponInfo)||[]}),b=P(()=>{var u;return(u=n.value)==null?void 0:u.returnCoinsInfo}),$=N(!1),l=()=>{var u,c;(c=(u=n.value)==null?void 0:u.returnCoinsInfo)!=null&&c.hasReturn||($.value=!0)};he(()=>W(this,null,function*(){var u;try{n.value=yield it(m.value)}catch(c){if(console.error(c),(c==null?void 0:c.code)=="4")return ue();q((c==null?void 0:c.msg)||"\u7F51\u7EDC\u9519\u8BEF")}if(((u=n.value)==null?void 0:u.orderState)==ee.WaitPay){let c=h();c||(E=setInterval(()=>{c=h(),c&&location.reload()},1e3))}$e({bizType:"127",pageLevelId:"121013559",pageParam:{orderid:m.value}})}));function h(){var U;const u=G(),c=G((U=n.value)==null?void 0:U.orderTime).add(1,"hours");if(c.isValid()){const F=c.diff(u,"seconds");if(F<=0)return clearInterval(E),s.value=`${0}\u5206${0}\u79D2`,!0;{const Y=Math.floor(F/60),Z=F%60;s.value=`${Y}\u5206${Z}\u79D2`}}else clearInterval(E),s.value="";return!1}const x=()=>{},D=()=>{location.href="/hzwdemo3/recharge?kwtarget=blank"},I=()=>W(this,null,function*(){var c;(yield Me((c=n.value)==null?void 0:c.orderId))?q("\u590D\u5236\u6210\u529F"):q("\u590D\u5236\u5931\u8D25")}),z=Ne.exports.debounce(()=>W(this,null,function*(){try{yield rt(m.value),location.reload()}catch(u){if(console.error(u),(u==null?void 0:u.code)=="4")return ue();q((u==null?void 0:u.msg)||"\u7F51\u7EDC\u9519\u8BEF")}}),3e3,{leading:!0,trailing:!1}),be=()=>{n.value&&De({orderId:n.value.orderId,partnerId:"3006",payOrderId:n.value.orderId,state:"1"})},ke=()=>{location.href=`/hzwdemo3/refund-detail?orderId=${m.value}&kwtarget=blank`};return(u,c)=>{const U=we;return n.value?(C(),y("div",Et,[t("div",{class:"order-bg",style:j({paddingTop:`${a(r)+a(B)}px`})},[a(i)&&a(r)>0?(C(),y("div",{key:0,class:"order-nav",style:j({top:`${a(r)}px`,height:`${a(B)}px`})},[t("i",{class:"nav-back",onClick:x})],4)):w("",!0),a(p).text?(C(),y("h1",xt,[t("i",{style:j({"background-image":`url(${a(p).icon})`})},null,4),L(v(a(p).text),1)])):w("",!0),n.value.orderState==a(ee).WaitPay&&s.value?(C(),y("p",Ft," \u8FD8\u5269 "+v(s.value)+" \u81EA\u52A8\u53D6\u6D88 ",1)):w("",!0),n.value.refundState==a(te).Succeed&&n.value.refundTime?(C(),y("p",St,v(a(G)(n.value.refundTime).format("YYYY-MM-DD HH:mm:ss"))+" \u9000\u6B3E\u5B8C\u6210 ",1)):w("",!0),n.value.refundState==a(te).Applying||n.value.refundState==a(te).Succeed?(C(),y("button",{key:4,class:"order-refund-detail",onClick:ke},[L(" \u9000\u6B3E\u8BE6\u60C5"),Pt])):w("",!0)],4),t("div",Tt,[a(R)?(C(),ie(U,{key:0,class:"product-comp",product:a(R),onClick:D},null,8,["product"])):w("",!0),a(T)?(C(),y("section",It,[At,t("ul",Ot,[t("li",$t,[Nt,t("div",Rt,v(n.value.rechargeAmount/100),1)]),t("li",zt,[Ht,t("div",Mt,v(n.value.giveAmount/100),1)]),t("li",Yt,[Lt,t("div",Vt,v(n.value.rechargeAmount/100+n.value.giveAmount/100),1)])]),Kt,t("ul",Ut,[t("li",Wt,[jt,t("div",qt,v(n.value.consume/100),1)]),t("li",Gt,[Qt,t("div",Jt,v(n.value.leftAmount/100),1)]),Xt])])):w("",!0),a(O).length>0||a(b)&&a(b).returnCoinNum>0?(C(),y("section",Zt,[en,t("ul",tn,[a(O).length>0?(C(),y("li",nn,[on,t("div",an,[(C(!0),y(ne,null,re(a(O),(F,Y)=>(C(),y("div",{key:Y},v(F),1))),128))])])):w("",!0),a(b)&&a(b).returnCoinNum>0?(C(),y(ne,{key:1},[t("li",sn,[ln,t("div",un,v(a(b).returnCoinNum/100),1)]),t("p",{class:Re(["promotion-tip",a(b).hasReturn?"has-return":""]),onClick:l},[L(v(a(k)),1),rn],2)],64)):w("",!0)])])):w("",!0),t("section",cn,[dn,t("ul",mn,[t("li",fn,[_n,t("div",vn,v(n.value.num),1)]),t("li",hn,[gn,t("div",pn," \xA5"+v(a(ce)(n.value.orderPrice)),1)]),t("li",Cn,[t("span",Bn,v(a(T)?"\u5B9E\u4ED8\u6B3E":"\u5E94\u4ED8\u6B3E"),1),t("div",yn,[L(" \xA5"),t("em",bn,v(a(ce)(n.value.payPrice)),1)])])]),kn,t("ul",Dn,[t("li",wn,[En,t("div",xn,[L(v(n.value.orderId),1),t("span",{style:j({color:"#ff397e",marginLeft:`${10/37.5}rem`}),onClick:I},"\u590D\u5236",4)])]),t("li",Fn,[Sn,t("div",Pn,v(a(G)(n.value.orderTime).format("YYYY-MM-DD HH:mm:ss")),1)]),t("li",Tn,[In,t("div",An,v(a(p).text),1)])])]),On]),n.value.orderState==a(ee).WaitPay?(C(),y("div",$n,[t("div",Nn,[t("button",{class:"cancel-button",onClick:c[0]||(c[0]=(...F)=>a(z)&&a(z)(...F))},"\u53D6\u6D88\u8BA2\u5355"),t("button",{class:"pay-button",onClick:be},"\u7ACB\u5373\u652F\u4ED8")]),Rn])):w("",!0),n.value.returnCoinsInfo?(C(),ie(a(d),{key:1,show:$.value,"onUpdate:show":c[1]||(c[1]=F=>$.value=F),"confirm-button-text":"\u77E5\u9053\u4E86"},{default:ze(()=>{var F;return[t("div",zn,[t("p",null," \u4E0B\u5355\u6210\u529F\u540E\uFF0C"+v(n.value.returnCoinsInfo.endTime?n.value.returnCoinsInfo.endTime+"\u4E4B\u524D":"")+"\u5728\u4EE5\u4E0B\u95E8\u5E97\u6838\u95001\u6B21\u5373\u53EF\u8FD4\u5E01\uFF1A ",1),(C(!0),y(ne,null,re((F=n.value)==null?void 0:F.returnCoinsInfo.storeInfo,(Y,Z)=>(C(),y("span",{key:Z},"\xB7"+v(Y.storeName),1))),128))])]}),_:1},8,["show"])):w("",!0)])):w("",!0)}}});var jn=lt(Hn,[["__scopeId","data-v-6c557337"]]);export{jn as default};
//# sourceMappingURL=OrderDetail.5a0b7846.js.map
