{"version":3,"file":"StoreList.f633580d.js","sources":["../../src/assets/images/store-list/icon-empty.png","../../src/views/store-list/StoreList.vue"],"sourcesContent":["export default \"__VITE_ASSET__8a3e6712__\"","<template>\n  <div class=\"store-list\">\n    <button class=\"select-button\" @click=\"cityClick\">\n      {{ cityName }}<i></i>\n    </button>\n    <ul v-if=\"storeList.length > 0\">\n      <li\n        v-for=\"item in storeList\"\n        :key=\"item.store_code\"\n        class=\"store-item\"\n        @click=\"storeClick(item)\"\n      >\n        <img :src=\"item.photo\" alt=\"\" class=\"store-img\" />\n        <div class=\"store-info\">\n          <h2 class=\"store-name pf-medium\">{{ item.store_name }}</h2>\n          <p class=\"store-address\">{{ item.address_street }}</p>\n          <span v-if=\"item.distance\" class=\"store-distance\">\n            <i></i>{{ getDistanceKm(item.distance) }}km\n          </span>\n        </div>\n      </li>\n    </ul>\n    <div v-else class=\"empty\">\n      <img src=\"@/assets/images/store-list/icon-empty.png\" alt=\"\" />\n      <p>当前城市暂无充值商品在售的门店</p>\n    </div>\n    <div class=\"menu_wkBox_back_box\"></div>\n  </div>\n</template>\n<script lang=\"ts\" setup>\nimport { queryStoreList } from '@/api/store'\nimport {\n  defaultCity,\n  getCityId,\n  getCityNameByCityId,\n  getDistanceKm,\n  getPosition,\n  setLoading,\n  setPage\n} from '@/utils'\nimport { StoreDetailType, StoreType } from '@/types/store'\nimport { onMounted, Ref, ref } from 'vue'\nimport { useRoute } from 'vue-router'\nimport queryString from 'query-string'\n\nsetLoading(true)\nsetPage({\n  title: '选择门店'\n})\n\nconst route = useRoute()\n\nconst storeList: Ref<StoreDetailType[]> = ref([])\n\nconst cityId = ref(<string>route.query.citycode)\nconst cityName = ref(<string>route.query.cityname)\n\nonMounted(async () => {\n  if (cityId.value) {\n    cityId.value = getCityId(cityId.value)\n    cityName.value = (\n      cityName.value || (await getCityNameByCityId(cityId.value))\n    ).replace('市', '')\n  } else {\n    cityId.value = defaultCity.cityId\n    cityName.value = defaultCity.cityName\n  }\n  const position = await getPosition()\n  try {\n    storeList.value = await queryStoreList(\n      cityId.value,\n      position?.lng,\n      position?.lat\n    )\n  } catch (error) {\n    console.error(error)\n  }\n  setLoading(false)\n})\n\nconst cityClick = () => {\n  location.href = `https://w.cekid.com/city-list.html?referer=${encodeURIComponent(\n    location.href\n  )}`\n}\n\nconst storeClick = (store: StoreType) => {\n  const url = queryString.stringifyUrl({\n    url: route.query.referer\n      ? decodeURIComponent(<string>route.query.referer)\n      : '/hzwdemo3/recharge',\n    query: {\n      cityId: cityId.value,\n      cityName: cityName.value,\n      storeCode: store.store_code,\n      storeName: store.store_name\n    }\n  })\n  location.href = url\n}\n</script>\n<style lang=\"scss\" scoped>\n.store-list {\n  padding: 20px 12px;\n  .select-button {\n    display: flex;\n    height: 17px;\n    font-size: 14px;\n    color: #262626;\n    align-items: center;\n    margin-bottom: 10px;\n    i {\n      width: 12px;\n      height: 12px;\n      background: url(@/assets/images/store-list/icon-arrow_down.png) 0 0/100%\n        100% no-repeat;\n      margin-left: 4px;\n    }\n  }\n  ul {\n    li {\n      display: flex;\n      padding: 12px;\n      border-radius: 8px;\n      background: #ffffff;\n      margin-bottom: 12px;\n      .store-img {\n        flex: none;\n        width: 77px;\n        height: 58px;\n        border-radius: 4px;\n        margin-right: 10px;\n      }\n      .store-info {\n        flex: 1;\n        overflow: hidden;\n        .store-name {\n          color: #262626;\n          font-size: 17px;\n          margin-bottom: 6px;\n          line-height: 21px;\n          @include ellicpsis;\n        }\n        .store-address {\n          color: #999999;\n          font-size: 12px;\n          margin-bottom: 12px;\n          line-height: 15px;\n          @include ellicpsis;\n        }\n        .store-distance {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          width: fit-content;\n          padding: 0 5px;\n          height: 16px;\n          border-radius: 8px 8px 0px 8px;\n          background: #f6f6f6;\n          color: #666666;\n          font-size: 10px;\n          i {\n            flex: none;\n            width: 10px;\n            height: 10px;\n            background: url(@/assets/images/store-list/icon-locate.png) 0 0/100%\n              100% no-repeat;\n            margin-right: 3px;\n          }\n        }\n      }\n    }\n  }\n  .empty {\n    margin: 100px 0;\n    img {\n      display: block;\n      width: 140px;\n      height: 140px;\n      margin: 0 auto 14px;\n    }\n    p {\n      color: #999999;\n      font-size: 14px;\n      line-height: 17px;\n      text-align: center;\n    }\n  }\n}\n</style>\n"],"names":["_imports_0","setLoading","setPage","route","useRoute","storeList","ref","cityId","cityName","onMounted","__async","getCityId","getCityNameByCityId","defaultCity","position","getPosition","queryStoreList","error","cityClick","storeClick","store","url","queryString"],"mappings":"qhBAAA,IAAeA,EAAA,slBC6CfC,EAAA,EAAA,EACAC,EAAA,CAAQ,MAAA,0BACC,CAAA,EAGT,MAAAC,EAAAC,IAEAC,EAAAC,EAAA,CAAA,CAAA,EAEAC,EAAAD,EAAAH,EAAA,MAAA,QAAA,EACAK,EAAAF,EAAAH,EAAA,MAAA,QAAA,EAEAM,EAAA,IAAAC,EAAA,sBACEH,EAAA,OACEA,EAAA,MAAAI,EAAAJ,EAAA,KAAA,EACAC,EAAA,OAAAA,EAAA,QAAA,MAAAI,EAAAL,EAAA,KAAA,IAAA,QAAA,SAAA,EAAA,IAIAA,EAAA,MAAAM,EAAA,OACAL,EAAA,MAAAK,EAAA,UAEF,MAAAC,EAAA,MAAAC,IACA,GAAA,CACEV,EAAA,MAAA,MAAAW,EAAwBT,EAAA,MACfO,GAAA,YAAAA,EAAA,IACGA,GAAA,YAAAA,EAAA,GACA,CACZ,OAAAG,EAAA,CAEA,QAAA,MAAAA,CAAA,CAAmB,CAErBhB,EAAA,EAAA,CAAgB,EAAA,EAGlB,MAAAiB,EAAA,IAAA,CACE,SAAA,KAAA,8CAAA,mBAA8D,SAAA,IACnD,GACX,EAGFC,EAAAC,GAAA,CACE,MAAAC,EAAAC,EAAA,aAAA,CAAqC,IAAAnB,EAAA,MAAA,QAAA,mBAAAA,EAAA,MAAA,OAAA,EAAA,qBAG/B,MAAA,CACG,OAAAI,EAAA,MACU,SAAAC,EAAA,MACI,UAAAY,EAAA,WACF,UAAAA,EAAA,UACA,CACnB,CAAA,EAEF,SAAA,KAAAC,CAAgB"}